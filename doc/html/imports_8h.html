<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PEter: /home/x/git-repos/PEter/src/imports.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PEter
   </div>
   <div id="projectbrief">manipulate portable executables</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">imports.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>These functions give you information about the import table.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="imports_8h__dep__incl.png" border="0" usemap="#_2home_2x_2git-repos_2PEter_2src_2imports_8hdep" alt=""/></div>
<map name="_2home_2x_2git-repos_2PEter_2src_2imports_8hdep" id="_2home_2x_2git-repos_2PEter_2src_2imports_8hdep">
<area shape="rect" id="node2" href="peter_8h.html" title="This file is the file you can actually include for using the library. It does nothing but including o..." alt="" coords="5,95,165,136"/>
</map>
</div>
</div>
<p><a href="imports_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8036faf1c005de380202f58ce21d7d69"><td class="memItemLeft" align="right" valign="top">IMAGE_IMPORT_DESCRIPTOR *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="imports_8h.html#a8036faf1c005de380202f58ce21d7d69">imports_by_index_get_import_descriptor</a> (void *image, int i)</td></tr>
<tr class="memdesc:a8036faf1c005de380202f58ce21d7d69"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the import descriptor with the index i  <a href="#a8036faf1c005de380202f58ce21d7d69">More...</a><br /></td></tr>
<tr class="separator:a8036faf1c005de380202f58ce21d7d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86884a4f94524df4230d626c416cb861"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="imports_8h.html#a86884a4f94524df4230d626c416cb861">imports_by_index_get_name</a> (void *image, int i)</td></tr>
<tr class="memdesc:a86884a4f94524df4230d626c416cb861"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns a char *pointer on the import descriptors name (the dll name)  <a href="#a86884a4f94524df4230d626c416cb861">More...</a><br /></td></tr>
<tr class="separator:a86884a4f94524df4230d626c416cb861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97c863ceb042fe8400260af874ab20a5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="imports_8h.html#a97c863ceb042fe8400260af874ab20a5">imports_by_name_get_index</a> (void *image, const char *name)</td></tr>
<tr class="memdesc:a97c863ceb042fe8400260af874ab20a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the import descroptor index that fits the name parameter  <a href="#a97c863ceb042fe8400260af874ab20a5">More...</a><br /></td></tr>
<tr class="separator:a97c863ceb042fe8400260af874ab20a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46d844dcd94f11ce99b7e158588ac4a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="imports_8h.html#a46d844dcd94f11ce99b7e158588ac4a9">imports_by_name_get_iname_index_by_name</a> (void *image, const char *dllName, const char *funcName)</td></tr>
<tr class="memdesc:a46d844dcd94f11ce99b7e158588ac4a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the index of the imported fucntion of a dll (that's not an ordinal)  <a href="#a46d844dcd94f11ce99b7e158588ac4a9">More...</a><br /></td></tr>
<tr class="separator:a46d844dcd94f11ce99b7e158588ac4a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a64f9e3e4b74e10be4770f1f6be8595"><td class="memItemLeft" align="right" valign="top">IMAGE_IMPORT_BY_NAME *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="imports_8h.html#a9a64f9e3e4b74e10be4770f1f6be8595">imports_by_index_get_iname_by_index</a> (void *image, int idtIdx, int intIdx)</td></tr>
<tr class="memdesc:a9a64f9e3e4b74e10be4770f1f6be8595"><td class="mdescLeft">&#160;</td><td class="mdescRight">you give it two indexes (import descriptor and its import name table) and you get the name of the function these two indexes discribe. That means you will get the first function name of the first imported dll if idtIdx and intIdx are both == 0. The returned pointer is an IMAGE_IMPORT_BY_NAME struct which is actually a uint8_t array but with a word (16bit) value at its start.  <a href="#a9a64f9e3e4b74e10be4770f1f6be8595">More...</a><br /></td></tr>
<tr class="separator:a9a64f9e3e4b74e10be4770f1f6be8595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9faff9e489626206a9a65fa6ddbe30e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="imports_8h.html#ab9faff9e489626206a9a65fa6ddbe30e">imports_by_index_get_iaddr_thunk_by_index</a> (void *image, int idtIdx, int iatIdx)</td></tr>
<tr class="memdesc:ab9faff9e489626206a9a65fa6ddbe30e"><td class="mdescLeft">&#160;</td><td class="mdescRight">like <a class="el" href="imports_8h.html#a9a64f9e3e4b74e10be4770f1f6be8595" title="you give it two indexes (import descriptor and its import name table) and you get the name of the fun...">imports_by_index_get_iname_by_index()</a> but doesn't return a name but a pointer on IMAGE_THUNK_DATA if it's a 32bit executable this function will return IMAGE_THUNK_DATA32 and if you have 64bit you may use the return value as a pointer on IMAGE_THUNK_DATA64  <a href="#ab9faff9e489626206a9a65fa6ddbe30e">More...</a><br /></td></tr>
<tr class="separator:ab9faff9e489626206a9a65fa6ddbe30e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef79655590df81878c67d7addb032f58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="imports_8h.html#aef79655590df81878c67d7addb032f58">imports_by_index_set_iaddr_thunk_by_index</a> (void *image, int idtIdx, int iatIdx, void *address)</td></tr>
<tr class="memdesc:aef79655590df81878c67d7addb032f58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes an address into the specified field of the import address table.  <a href="#aef79655590df81878c67d7addb032f58">More...</a><br /></td></tr>
<tr class="separator:aef79655590df81878c67d7addb032f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>These functions give you information about the import table. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab9faff9e489626206a9a65fa6ddbe30e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9faff9e489626206a9a65fa6ddbe30e">&#9670;&nbsp;</a></span>imports_by_index_get_iaddr_thunk_by_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* imports_by_index_get_iaddr_thunk_by_index </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idtIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iatIdx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>like <a class="el" href="imports_8h.html#a9a64f9e3e4b74e10be4770f1f6be8595" title="you give it two indexes (import descriptor and its import name table) and you get the name of the fun...">imports_by_index_get_iname_by_index()</a> but doesn't return a name but a pointer on IMAGE_THUNK_DATA if it's a 32bit executable this function will return IMAGE_THUNK_DATA32 and if you have 64bit you may use the return value as a pointer on IMAGE_THUNK_DATA64 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>is the PE file </td></tr>
    <tr><td class="paramname">idtIdx</td><td>is an import descriptor index </td></tr>
    <tr><td class="paramname">iatIdx</td><td>is the address table index </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8036faf1c005de380202f58ce21d7d69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8036faf1c005de380202f58ce21d7d69">&#9670;&nbsp;</a></span>imports_by_index_get_import_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IMAGE_IMPORT_DESCRIPTOR* imports_by_index_get_import_descriptor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idtIdx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return the import descriptor with the index i </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>points to the image you want to analyze </td></tr>
    <tr><td class="paramname">i</td><td>is 0 if you need the first import descriptor i = 1 for the second and so on </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9a64f9e3e4b74e10be4770f1f6be8595"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a64f9e3e4b74e10be4770f1f6be8595">&#9670;&nbsp;</a></span>imports_by_index_get_iname_by_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IMAGE_IMPORT_BY_NAME* imports_by_index_get_iname_by_index </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idtIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>intIdx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>you give it two indexes (import descriptor and its import name table) and you get the name of the function these two indexes discribe. That means you will get the first function name of the first imported dll if idtIdx and intIdx are both == 0. The returned pointer is an IMAGE_IMPORT_BY_NAME struct which is actually a uint8_t array but with a word (16bit) value at its start. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>points to the PE file </td></tr>
    <tr><td class="paramname">idtIdx</td><td>is the import descriptor index (starting at 0 for the first import descriptor) </td></tr>
    <tr><td class="paramname">intIdx</td><td>is the name table index (also starting with 0) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a86884a4f94524df4230d626c416cb861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86884a4f94524df4230d626c416cb861">&#9670;&nbsp;</a></span>imports_by_index_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* imports_by_index_get_name </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idtIdx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns a char *pointer on the import descriptors name (the dll name) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>points tor the image you want to analyzee </td></tr>
    <tr><td class="paramname">i</td><td>is an index indicating which import disc. you want the name of (starting with 0) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aef79655590df81878c67d7addb032f58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef79655590df81878c67d7addb032f58">&#9670;&nbsp;</a></span>imports_by_index_set_iaddr_thunk_by_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void imports_by_index_set_iaddr_thunk_by_index </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idtIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iatIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes an address into the specified field of the import address table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>is the PE file. </td></tr>
    <tr><td class="paramname">idtIdx</td><td>is the import descriptor index. </td></tr>
    <tr><td class="paramname">iatIdx</td><td>is the address table index. </td></tr>
    <tr><td class="paramname">address</td><td>is the address you want to write. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a46d844dcd94f11ce99b7e158588ac4a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46d844dcd94f11ce99b7e158588ac4a9">&#9670;&nbsp;</a></span>imports_by_name_get_iname_index_by_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int imports_by_name_get_iname_index_by_name </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dllName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>funcName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the index of the imported fucntion of a dll (that's not an ordinal) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>points to the PE file you want information of </td></tr>
    <tr><td class="paramname">dllName</td><td>is the name of the dll (import descriptor name) where the function name resides in </td></tr>
    <tr><td class="paramname">funcName</td><td>is the name of the function you want the index of </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a97c863ceb042fe8400260af874ab20a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97c863ceb042fe8400260af874ab20a5">&#9670;&nbsp;</a></span>imports_by_name_get_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int imports_by_name_get_index </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the import descroptor index that fits the name parameter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>points on the image you want to analyze </td></tr>
    <tr><td class="paramname">name</td><td>the dll name (== import descriptor name) you want the idx of </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
